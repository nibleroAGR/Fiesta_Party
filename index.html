<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no">
    <title>Fiesta Party üéà | Encuentra tu fiesta ideal</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Outfit:wght@500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Phosphor Icons for professional iconography -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
</head>

<body>

    <div id="app">



        <!-- LANDING PAGE -->
        <section id="landing-view" class="view active">
            <header class="hero-header">
                <div class="top-auth-links">
                    <a href="#"
                        onclick="event.preventDefault(); window.setAuthMode(true); showAuth('family')">Registro</a>
                    <a href="#" onclick="event.preventDefault(); window.setAuthMode(false); showAuth('family')">Iniciar
                        Sesi√≥n</a>
                </div>
                <img src="fiesta_logo.png" class="hero-logo" alt="Fiesta Party Logo">
                <!-- Tabs removed as requested -->
            </header>

            <div class="search-container">
                <div class="search-card">
                    <div class="search-field">
                        <i class="ph ph-map-pin"></i>
                        <input type="text" id="search-location" placeholder="¬øD√≥nde es el cumple?" list="cities-list"
                            autocomplete="off">
                        <datalist id="cities-list"></datalist>
                    </div>

                    <button class="btn-search" onclick="applySearch()">¬°BUSCAR LOCAL!</button>
                </div>
            </div>



            <!-- Added Registered Venues Grid directly on landing -->
            <div class="venues-grid" id="venues-list-landing" style="padding: 24px;">
                <!-- Venues will load here -->
            </div>

            <div class="footer-biz"
                style="margin: 20px; margin-bottom: 40px; padding: 24px; background: white; border-radius: 20px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05); text-align: center;">
                <h3 style="margin-bottom: 10px;">¬øTienes un negocio?</h3>
                <p style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: 15px;">√önete a Fiesta Party y
                    llega
                    a cientos de familias en tu zona.</p>
                <button onclick="window.setAuthMode(false); showAuth('business')" class="btn-secondary">Somos
                    empresa</button>
            </div>
        </section>

        <!-- AUTH SECTION -->
        <section id="auth-view" class="view hidden">
            <div class="card auth-card">
                <button onclick="showView('landing-view')" class="back-btn"><i class="ph ph-arrow-left"></i></button>
                <div style="text-align: center; margin-bottom: 30px;">
                    <img src="fiesta_logo.png" alt="Fiesta Party Logo"
                        style="width: 70%; max-width: 400px; height: auto;">
                </div>
                <h2 id="auth-title">Acceso Familia</h2>
                <p id="auth-subtitle">Encuentra el lugar perfecto</p>

                <form id="auth-form">
                    <div class="input-group">
                        <label>Email</label>
                        <input type="email" id="email" required placeholder="hola@ejemplo.com">
                    </div>
                    <div class="input-group">
                        <label>Contrase√±a</label>
                        <input type="password" id="password" required placeholder="********">
                    </div>

                    <!-- Extra fields for registration -->
                    <div id="register-fields" class="hidden">
                        <div class="input-group">
                            <label>Nombre Completo</label>
                            <input type="text" id="full-name" placeholder="Tu nombre">
                        </div>
                    </div>

                    <button type="submit" id="auth-action-btn">Entrar</button>
                </form>

                <div class="auth-divider">
                    <span>O accede con</span>
                </div>

                <button onclick="signInWithGoogle()" class="google-btn">
                    <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google">
                    Continuar con Google
                </button>


                <p class="switch-auth">
                    <span id="switch-text">¬øNo tienes cuenta?</span>
                    <button id="toggle-auth-mode" class="text-btn">Reg√≠strate</button>
                </p>
            </div>
        </section>

        <!-- APP: FAMILY DASHBOARD (EXPLORE) -->
        <section id="family-view" class="view hidden">
            <header class="app-header-responsive"
                style="background: transparent; margin-bottom: 20px; display: flex; flex-direction: column; align-items: flex-start; position: relative;">
                <h1 class="colorful-logo" style="margin-left: 0; text-align: left;">Fiesta Party</h1>
                <div class="user-pill" onclick="logout()"
                    style="position: absolute; top: 15px; right: 20px; cursor: pointer; background: #fdf2f8; padding: 4px 4px 4px 12px; border-radius: 50px; display: flex; align-items: center; gap: 8px;">
                    <div style="text-align: right; line-height: 1.2;">
                        <span id="user-name-display"
                            style="display:block; color: var(--primary); font-weight: 700;">Usuario</span>
                        <small style="font-size: 0.7rem; color: var(--secondary);">Salir</small>
                    </div>
                    <div class="avatar" style="background: white;">üë§</div>
                </div>
            </header>

            <div class="search-container" style="margin-top: 0; padding-top: 0;">
                <div class="search-card">
                    <div class="search-field">
                        <i class="ph ph-map-pin"></i>
                        <input type="text" id="family-search-location" placeholder="¬øD√≥nde es el cumple?"
                            list="cities-list" autocomplete="off" style="width: 100%;">
                    </div>
                    <button class="btn-search" onclick="applySearch()">¬°BUSCAR LOCAL!</button>
                </div>
            </div>

            <div class="venues-grid" id="venues-list" style="padding: 24px;">
                <!-- Venues will load here -->
            </div>

            <!-- Spacer for bottom nav -->
            <div style="height: 80px;"></div>
        </section>

        <!-- APP: RESERVATION VIEW -->
        <section id="reservation-view" class="view hidden">
            <header class="section-title-header">
                <h2>Mi Fiesta üéà</h2>
            </header>
            <div id="active-reservation-container" class="container-padding">
                <p style="text-align:center; color:#999; margin-top:50px;">Cargando reservas...</p>
            </div>
            <div style="height: 80px;"></div>
        </section>

        <!-- APP: INVITATIONS VIEW -->
        <section id="invitations-view" class="view hidden">
            <header class="section-title-header">
                <h2>Invitados üíå</h2>
            </header>
            <div class="container-padding">
                <div class="add-item-row">
                    <input type="text" id="new-guest-name" placeholder="Nombre del invitado">
                    <button onclick="addGuest()" class="btn-primary btn-add">+</button>
                </div>

                <div id="guests-list" class="guests-list"></div>
            </div>
            <div style="height: 80px;"></div>
        </section>

        <!-- APP: NOTES VIEW -->
        <section id="notes-view" class="view hidden">
            <header class="section-title-header">
                <h2>Notas üìù</h2>
            </header>
            <div class="container-padding">
                <div class="add-item-row">
                    <input type="text" id="new-note-text" placeholder="Nueva tarea...">
                    <button onclick="addNote()" class="btn-primary btn-add">+</button>
                </div>

                <h3 style="margin-bottom:10px; color:var(--text-muted); font-size:0.9rem;">Cosas por hacer</h3>
                <div id="notes-todo" class="notes-container" ondrop="drop(event, 'todo')" ondragover="allowDrop(event)">
                    <!-- Draggable Notes -->
                </div>

                <h3 style="margin-top:30px; margin-bottom:10px; color:var(--text-muted); font-size:0.9rem;">Cosas
                    Cumplidas</h3>
                <div id="notes-done" class="notes-container" ondrop="drop(event, 'done')" ondragover="allowDrop(event)">
                    <!-- Done Notes -->
                </div>
            </div>
            <div style="height: 80px;"></div>
        </section>

        <!-- APP: FAMILY PROFILE VIEW -->
        <section id="family-profile-view" class="view hidden">
            <header class="section-title-header">
                <h2>Mi Perfil üë§</h2>
            </header>
            <div class="container-padding">
                <div class="card">
                    <form id="family-profile-form" onsubmit="event.preventDefault()">
                        <div class="form-section">
                            <h3><i class="ph ph-user-circle"></i> Mi Informaci√≥n</h3>
                            <div class="input-group">
                                <label><i class="ph ph-user"></i> Nombre Completo</label>
                                <input type="text" id="user-name" placeholder="Tu nombre">
                            </div>
                            <div class="input-group">
                                <label><i class="ph ph-envelope-simple"></i> Email de contacto</label>
                                <input type="email" id="user-contact-email" placeholder="ejemplo@correo.com">
                            </div>
                            <div class="input-group">
                                <label><i class="ph ph-phone"></i> Tel√©fono</label>
                                <input type="tel" id="user-phone" placeholder="600 000 000">
                            </div>
                        </div>
                        <p style="font-size: 0.8rem; color: #666; margin-bottom: 5px;">
                            * Los cambios se guardan autom√°ticamente.
                        </p>
                    </form>
                </div>

                <div style="margin-top: 20px; text-align: center;">
                    <button onclick="logout()" class="btn-secondary"
                        style="width: 100%; background: #fef2f2; color: #ef4444; border-color: #fecaca; margin-bottom: 15px;">
                        <i class="ph ph-sign-out"></i> Cerrar Sesi√≥n
                    </button>
                    <p style="font-size: 0.75rem; color: #a0aec0;">ID de usuario: <span id="user-id-display"
                            style="font-family: monospace;"></span></p>
                </div>
            </div>
            <div style="height: 80px;"></div>
        </section>

        <!-- FAMILY BOTTOM NAV -->
        <nav id="family-nav" class="bottom-nav hidden">
            <div class="nav-item active" onclick="switchFamilyTab('family-view', this)">
                <i class="ph ph-magnifying-glass"></i>
            </div>
            <div class="nav-item" onclick="switchFamilyTab('reservation-view', this)">
                <i class="ph ph-storefront"></i>
            </div>
            <div class="nav-item" onclick="switchFamilyTab('invitations-view', this)">
                <i class="ph ph-users"></i>
            </div>
            <div class="nav-item" onclick="switchFamilyTab('notes-view', this)">
                <i class="ph ph-notebook"></i>
            </div>
            <div class="nav-item" onclick="switchFamilyTab('family-profile-view', this)">
                <i class="ph ph-gear"></i>
            </div>
        </nav>

        <!-- BUSINESS BOTTOM NAV -->
        <nav id="business-nav" class="bottom-nav hidden">
            <div class="nav-item" onclick="switchBusinessTab('business-reservations-view', this)">
                <i class="ph ph-calendar-check"></i>
            </div>
            <div class="nav-item" onclick="switchBusinessTab('business-notifications-view', this)">
                <i class="ph ph-bell"></i>
            </div>
            <div class="nav-item" onclick="switchBusinessTab('business-billing-view', this)">
                <i class="ph ph-receipt"></i>
            </div>
            <div class="nav-item active" onclick="switchBusinessTab('business-view', this)">
                <i class="ph ph-gear"></i>
            </div>
        </nav>

        <!-- APP: BUSINESS RESERVATIONS -->
        <section id="business-reservations-view" class="view hidden">
            <header class="section-title-header">
                <h2>Reservas üìÖ</h2>
            </header>
            <div class="container-padding">
                <div id="business-reservations-list">
                    <p style="text-align:center; color:#999; margin-top:50px;">Pr√≥ximamente: Listado de reservas.</p>
                </div>
            </div>
            <div style="height: 80px;"></div>
        </section>

        <!-- APP: BUSINESS NOTIFICATIONS -->
        <section id="business-notifications-view" class="view hidden">
            <header class="section-title-header">
                <h2>Notificaciones üîî</h2>
            </header>
            <div class="container-padding">
                <div id="business-notifications-list">
                    <p style="text-align:center; color:#999; margin-top:50px;">No tienes notificaciones nuevas.</p>
                </div>
            </div>
            <div style="height: 80px;"></div>
        </section>

        <!-- APP: BUSINESS HISTORY -->
        <section id="business-history-view" class="view hidden">
            <header class="section-title-header">
                <button onclick="switchBusinessTab('business-billing-view')" class="back-btn"
                    style="position:absolute; left:20px; top:25px; background:none; border:none; font-size:1.5rem;"><i
                        class="ph ph-arrow-left"></i></button>
                <h2>Historial ‚è≥</h2>
            </header>
            <div class="container-padding">
                <div id="business-history-list">
                    <p style="text-align:center; color:#999; margin-top:50px;">Cargando historial...</p>
                </div>
            </div>
            <div style="height: 80px;"></div>
        </section>

        <!-- APP: BUSINESS BILLING -->
        <section id="business-billing-view" class="view hidden">
            <header class="section-title-header">
                <h2>Facturaci√≥n üßæ</h2>
            </header>
            <div class="container-padding">
                <div id="business-billing-list">
                    <p style="text-align:center; color:#999; margin-top:50px;">Cargando facturaci√≥n...</p>
                </div>

                <div style="margin-top: 30px; display: flex; flex-direction: column; gap: 15px;">
                    <button onclick="switchBusinessTab('business-billing-history-view')" class="btn-primary"
                        style="background: var(--secondary);">
                        <i class="ph ph-files"></i> Historial de Facturaci√≥n
                    </button>

                    <button onclick="switchBusinessTab('business-history-view')" class="btn-secondary">
                        <i class="ph ph-clock-counter-clockwise"></i> Historial de Reservas
                    </button>

                    <p style="text-align: center; font-size: 0.8rem; color: var(--text-muted);">
                        * Las reservas se conservan en el historial durante 60 d√≠as.
                    </p>
                </div>
            </div>
            <div style="height: 80px;"></div>
        </section>

        <!-- APP: BUSINESS BILLING HISTORY -->
        <section id="business-billing-history-view" class="view hidden">
            <header class="section-title-header">
                <button onclick="switchBusinessTab('business-billing-view')" class="back-btn"
                    style="position:absolute; left:20px; top:25px; background:none; border:none; font-size:1.5rem;"><i
                        class="ph ph-arrow-left"></i></button>
                <h2>Historial Facturas üìÇ</h2>
            </header>
            <div class="container-padding">
                <!-- Filters -->
                <div class="card" style="margin-bottom: 20px; padding: 15px;">
                    <h4 style="margin-bottom: 10px; font-size: 0.9rem;"><i class="ph ph-funnel"></i> Filtros</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                        <div>
                            <label style="font-size: 0.7rem; font-weight: 700;">Desde</label>
                            <input type="date" id="filter-billing-start"
                                style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 8px;">
                        </div>
                        <div>
                            <label style="font-size: 0.7rem; font-weight: 700;">Hasta</label>
                            <input type="date" id="filter-billing-end"
                                style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 8px;">
                        </div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label style="font-size: 0.7rem; font-weight: 700;">Total M√≠nimo (‚Ç¨)</label>
                        <input type="number" id="filter-billing-min" placeholder="0"
                            style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 8px;">
                    </div>
                    <button onclick="loadBusinessBillingHistory()" class="btn-primary"
                        style="width:100%; padding: 10px;">Aplicar Filtros</button>
                </div>

                <div id="billing-history-results">
                    <!-- History results -->
                </div>
            </div>
            <div style="height: 80px;"></div>
        </section>

        <!-- APP: BUSINESS STATS -->
        <section id="business-stats-view" class="view hidden">
            <header class="section-title-header" style="background: linear-gradient(135deg, #eff6ff 0%, #ffffff 100%);">
                <button onclick="switchBusinessTab('business-view')" class="back-btn"
                    style="position:absolute; left:20px; top:25px; background:none; border:none; font-size:1.5rem;"><i
                        class="ph ph-arrow-left"></i></button>
                <h2 style="padding: 20px 0; text-align: center;">Estad√≠sticas üìä</h2>
            </header>
            <div class="container-padding">
                <div id="stats-content">
                    <p style="text-align:center; color:#999; margin-top:50px;">Cargando estad√≠sticas...</p>
                </div>
            </div>
            <div style="height: 80px;"></div>
        </section>

        <!-- APP: BUSINESS DASHBOARD (CONFIGURACION / DASHBOARD) -->
        <section id="business-view" class="view hidden">
            <header class="app-header business-header"
                style="background: transparent; margin-bottom: 20px; display: flex; flex-direction: column; align-items: flex-start; position: relative;">
                <h1 class="colorful-logo" style="margin-left: 0; text-align: left;">Fiesta Party</h1>
                <div class="user-pill" onclick="logout()"
                    style="position: absolute; top: 15px; right: 20px; cursor: pointer; background: #fdf2f8; padding: 4px 4px 4px 12px; border-radius: 50px; display: flex; align-items: center; gap: 8px;">
                    <div style="text-align: right; line-height: 1.2;">
                        <span id="biz-name-display"
                            style="display:block; color: var(--primary); font-weight: 700;">Empresa</span>
                        <small style="font-size: 0.7rem; color: var(--secondary);">Salir</small>
                    </div>
                    <div class="avatar" style="background: white;">üíº</div>
                </div>
            </header>

            <div class="stats-row">
                <div class="stat-card" style="cursor: pointer; position: relative;"
                    onclick="switchBusinessTab('business-stats-view')">
                    <span class="stat-num" id="stat-reservations">0</span>
                    <span class="stat-label">Reservas Totales</span>
                    <i class="ph ph-chart-line-up"
                        style="position: absolute; top: 10px; right: 10px; opacity: 0.3;"></i>
                </div>
                <div class="stat-card" style="cursor: pointer; position: relative;"
                    onclick="switchBusinessTab('business-stats-view')">
                    <span class="stat-num" id="stat-visits">0</span>
                    <span class="stat-label">Visitas Perfil</span>
                    <i class="ph ph-chart-bar" style="position: absolute; top: 10px; right: 10px; opacity: 0.3;"></i>
                </div>
            </div>
            <div style="padding: 0 20px; margin-bottom: 20px;">
                <button onclick="switchBusinessTab('business-stats-view')" class="btn-primary" style="width: 100%;"><i
                        class="ph ph-chart-pie-slice"></i> Ver Estad√≠sticas Detalladas</button>
            </div>
            <div class="card">
                <h3>Gestionar Perfil</h3>
                <form id="venue-form">

                    <!-- Informaci√≥n B√°sica -->
                    <div class="form-section">
                        <h3><i class="ph ph-storefront"></i> Informaci√≥n Principal</h3>
                        <div class="input-group">
                            <label>Nombre del Local</label>
                            <input type="text" id="venue-name" placeholder="Ej. Diverlandia">
                        </div>
                        <div class="input-group">
                            <label>Descripci√≥n</label>
                            <textarea id="venue-desc" rows="3" placeholder="Describe tu local..."></textarea>
                        </div>
                        <div class="form-row">
                            <div class="input-group">
                                <label>Email de Reservas</label>
                                <input type="email" id="venue-email" placeholder="contacto@local.com">
                            </div>
                            <div class="input-group">
                                <label>Tel√©fono de Contacto</label>
                                <input type="tel" id="venue-phone" placeholder="600 000 000">
                            </div>
                        </div>
                    </div>

                    <!-- Ubicaci√≥n -->
                    <div class="form-section">
                        <h3><i class="ph ph-map-pin"></i> Ubicaci√≥n</h3>
                        <div class="form-row">
                            <div class="input-group">
                                <label>Ciudad</label>
                                <input type="text" id="venue-city" placeholder="Ej: Madrid">
                            </div>
                            <div class="input-group">
                                <label>Direcci√≥n Completa</label>
                                <input type="text" id="venue-address" placeholder="C/ Ejemplo, 123">
                            </div>
                        </div>
                    </div>

                    <!-- Detalles del Negocio -->
                    <div class="form-section">
                        <h3><i class="ph ph-info"></i> Detalles del Negocio</h3>
                        <div class="input-group">
                            <label>Etiquetas (Separadas por comas)</label>
                            <input type="text" id="venue-tags" placeholder="Ej. Bolas, Hinchables, Merienda...">
                        </div>
                        <div class="form-row">
                            <div class="input-group">
                                <label>Precio / ni√±o (‚Ç¨)</label>
                                <input type="number" id="venue-price">
                            </div>
                            <div class="input-group">
                                <label>M√≠n. Ni√±os</label>
                                <input type="number" id="venue-min-kids" value="10">
                            </div>
                            <div class="input-group">
                                <label>Aforo M√°x.</label>
                                <input type="number" id="venue-capacity">
                            </div>
                        </div>
                    </div>

                    <!-- Multimedia -->
                    <div class="form-section">
                        <h3><i class="ph ph-image"></i> Fotos del Local</h3>
                        <div class="input-group">
                            <label>Foto de Portada</label>
                            <input type="file" id="venue-cover-input" accept="image/*">
                            <div id="cover-preview"
                                style="margin-top:10px; height:150px; background:#f0f0f0; border-radius:12px; background-size:cover; background-position:center;">
                            </div>
                        </div>
                        <div class="input-group" style="margin-top: 20px;">
                            <label>Galer√≠a (Opcional)</label>
                            <input type="file" id="venue-gallery-input" accept="image/*" multiple>
                        </div>
                        <div id="gallery-preview-grid" class="gallery-grid"></div>
                    </div>

                    <!-- Servicios Extra -->
                    <div class="form-section">
                        <h3><i class="ph ph-sparkle"></i> Servicios Extra</h3>
                        <div class="services-manager">
                            <ul id="business-services-list"></ul>
                            <div class="form-row" style="margin-top:10px; align-items: flex-end;">
                                <div class="input-group" style="flex: 2; margin-bottom: 0;">
                                    <input type="text" id="new-service-name" placeholder="Nombre (ej. Tarta)"
                                        style="margin-bottom:0;">
                                </div>
                                <div class="input-group" style="flex: 1; margin-bottom: 0;">
                                    <input type="number" id="new-service-price" placeholder="‚Ç¨"
                                        style="margin-bottom:0;">
                                </div>
                                <button type="button" id="btn-add-service" class="btn-secondary"
                                    style="width:auto; padding: 14px;">+</button>
                            </div>
                        </div>
                    </div>

                    <!-- Horarios -->
                    <div class="form-section">
                        <h3><i class="ph ph-calendar"></i> Disponibilidad</h3>
                        <div
                            style="background: #fdf2f8; padding: 15px; border-radius: 12px; border: 1px solid #fce7f3;">
                            <h4 style="margin-bottom: 10px; font-size: 0.9rem;">D√≠as de Apertura</h4>
                            <div class="days-grid"
                                style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-bottom: 15px;">
                                <label><input type="checkbox" name="openDays" value="1"> Lun</label>
                                <label><input type="checkbox" name="openDays" value="2"> Mar</label>
                                <label><input type="checkbox" name="openDays" value="3"> Mi√©</label>
                                <label><input type="checkbox" name="openDays" value="4"> Jue</label>
                                <label><input type="checkbox" name="openDays" value="5"> Vie</label>
                                <label><input type="checkbox" name="openDays" value="6"> S√°b</label>
                                <label><input type="checkbox" name="openDays" value="0"> Dom</label>
                            </div>

                            <h4 style="margin-bottom: 10px; font-size: 0.9rem;">Horas de Inicio</h4>
                            <div class="form-row" style="margin-bottom: 10px; align-items: center;">
                                <input type="time" id="new-slot-time">
                                <button type="button" id="btn-add-slot" class="btn-secondary"
                                    style="width: auto;">+</button>
                            </div>
                            <div id="slots-list" style="display: flex; flex-wrap: wrap; gap: 8px;"></div>

                            <h4 style="margin-top: 20px; margin-bottom: 10px; font-size: 0.9rem; color: #ef4444;">
                                Bloquear Fechas</h4>
                            <div class="form-row" style="margin-bottom: 10px; align-items: center;">
                                <input type="date" id="new-blocked-date">
                                <button type="button" id="btn-block-date"
                                    style="background: #ef4444; color: white; border: none; border-radius: 12px; padding: 14px;">Bloquear</button>
                            </div>
                            <div id="blocked-dates-list" style="display: flex; flex-direction: column; gap: 5px;"></div>
                        </div>
                    </div>

                    <button type="submit" class="btn-save">Guardar Cambios</button>
                </form>
            </div>
            <div style="height: 80px;"></div>
        </section>

        <!-- APP: VENUE DETAIL VIEW (FAMILY) -->
        <section id="venue-detail-view" class="view hidden">
            <button onclick="showView('family-view')" class="back-btn"
                style="position:fixed; z-index:10; background:rgba(255,255,255,0.8); padding:10px; border-radius:50%; box-shadow:0 4px 10px rgba(0,0,0,0.1);"><i
                    class="ph ph-arrow-left"></i></button>

            <div id="detail-cover" class="detail-hero"></div>

            <div class="detail-content">
                <h1 id="detail-name">Nombre Local</h1>
                <div class="detail-meta">
                    <span id="detail-price" class="venue-price">0‚Ç¨</span>
                    <span><i class="ph ph-users"></i> <span id="detail-capacity">0</span> pax</span>
                </div>

                <p id="detail-desc" class="venue-desc">Descripci√≥n...</p>

                <h3>Galer√≠a</h3>
                <div id="detail-gallery" class="gallery-grid full-width"></div>

                <h3>Servicios Adicionales</h3>
                <div id="detail-services-list" class="services-selection">
                    <!-- Checkboxes for services -->
                </div>

                <div class="booking-controls"
                    style="margin-top: 20px; background: #f9fafb; padding: 15px; border-radius: 12px;">
                    <div style="display: flex; gap: 15px; margin-bottom: 15px;">
                        <div style="flex: 1;">
                            <label
                                style="display: block; font-size: 0.8rem; font-weight: 700; color: var(--text-muted); margin-bottom: 5px;">N¬∫
                                Ni√±os</label>
                            <input type="number" id="booking-kids" min="1" value="10" oninput="calcTotal()"
                                style="width: 100%; padding: 10px; border: 1px solid var(--border-light); border-radius: 8px;">
                        </div>
                        <div style="flex: 1;">
                            <label
                                style="display: block; font-size: 0.8rem; font-weight: 700; color: var(--text-muted); margin-bottom: 5px;">Fecha</label>
                            <input type="date" id="booking-date" onchange="validateBookingDate()"
                                style="width: 100%; padding: 10px; border: 1px solid var(--border-light); border-radius: 8px; font-family: inherit;">
                        </div>
                    </div>
                    <div style="margin-bottom: 5px;">
                        <label
                            style="display: block; font-size: 0.8rem; font-weight: 700; color: var(--text-muted); margin-bottom: 5px;">Hora
                            de Inicio</label>
                        <select id="booking-time" disabled
                            style="width: 100%; padding: 10px; border: 1px solid var(--border-light); border-radius: 8px; background: white;">
                            <option value="">Selecciona fecha primero...</option>
                        </select>
                    </div>
                </div>

                <div class="booking-dock">
                    <div class="total-price">
                        <small>Total estimado</small>
                        <span id="booking-total">0‚Ç¨</span>
                    </div>
                    <div id="booking-button-container">
                        <button id="book-btn" class="btn-primary" onclick="attemptBooking()">Solicitar Reserva</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- GLOBAL FOOTER (LINKS) -->
        <footer class="global-footer"
            style="padding: 30px 20px 120px 20px; text-align: center; background: #f8f9fa; margin-top: auto;">
            <div class="footer-links" style="display: flex; flex-wrap: wrap; justify-content: center; gap: 15px;">
                <a href="#" style="color: #718096; text-decoration: none; font-size: 0.8rem;">Pol√≠tica de Privacidad</a>
                <a href="#" style="color: #718096; text-decoration: none; font-size: 0.8rem;">Pol√≠tica de Cookies</a>
                <a href="#" style="color: #718096; text-decoration: none; font-size: 0.8rem;">Aviso Legal</a>
                <a href="#" style="color: #718096; text-decoration: none; font-size: 0.8rem;">Contacto</a>
            </div>
            <p style="margin-top: 20px; font-size: 0.75rem; color: #a0aec0;">&copy; 2026 Fiesta Party</p>
        </footer>

        <!-- CHAT MODAL -->
        <div id="chat-modal" class="modal hidden">
            <div class="modal-content chat-modal-content">
                <div class="chat-header">
                    <button onclick="closeChat()" class="back-btn" style="position: static; margin-right: 10px;"><i
                            class="ph ph-arrow-left"></i></button>
                    <div style="flex: 1;">
                        <h3 id="chat-venue-name" style="margin: 0; font-size: 1.1rem;">Chat</h3>
                        <p style="margin: 0; font-size: 0.75rem; color: var(--text-muted);">Conversaci√≥n con el local
                        </p>
                    </div>
                </div>
                <div id="chat-messages" class="chat-messages">
                    <!-- Messages will be loaded here -->
                </div>
                <div class="chat-input-container">
                    <input type="text" id="chat-input" placeholder="Escribe un mensaje..."
                        onkeypress="if(event.key==='Enter') sendChatMessage()">
                    <button onclick="sendChatMessage()" class="btn-send-chat"><i
                            class="ph ph-paper-plane-tilt"></i></button>
                </div>
            </div>
        </div>

        <!-- CUSTOM ALERT MODAL -->
        <div id="custom-alert-modal" class="custom-modal hidden">
            <div class="custom-modal-overlay" onclick="closeCustomAlert()"></div>
            <div class="custom-modal-content">
                <div class="custom-modal-icon">
                    <i class="ph ph-info"></i>
                </div>
                <div id="custom-alert-message" class="custom-modal-message"></div>
                <button onclick="closeCustomAlert()" class="custom-modal-btn">Aceptar</button>
            </div>
        </div>

        <!-- CUSTOM CONFIRM MODAL -->
        <div id="custom-confirm-modal" class="custom-modal hidden">
            <div class="custom-modal-overlay" onclick="closeCustomConfirm(false)"></div>
            <div class="custom-modal-content">
                <div class="custom-modal-icon confirm">
                    <i class="ph ph-question"></i>
                </div>
                <div id="custom-confirm-message" class="custom-modal-message"></div>
                <div class="custom-modal-buttons">
                    <button onclick="closeCustomConfirm(false)" class="custom-modal-btn secondary">Cancelar</button>
                    <button onclick="closeCustomConfirm(true)" class="custom-modal-btn">Aceptar</button>
                </div>
            </div>
        </div>

    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.2/firebase-firestore-compat.js"></script>
    <!-- PDF Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="app.js"></script>
    <!-- Hidden clock for internal use -->
    <div id="hidden-system-clock" style="display:none;"></div>
</body>

</html>